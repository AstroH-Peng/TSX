#!/usr/bin/env python
# -*- coding: utf-8 -*-
#N

import numpy as np
import scipy as sp

import PyKEP as pk

import date
import position 
import velocity
import trajectory_parser
import propagator

class Builder:
    """Class building the trajectory.

    Attributes defined here:
    -epoch
    -step_time:
    -bodies:

    Methods defined here:
    -bld(): 
    -acc():
    -get_traj():

    """
    #def __init__(self, *args):
	#"""Constructor of the class Builder."""
	#pass
    def compute_traj(self, date, pos, vel, step_time, step_number, bodies):
	"""Compute the trajectory of the spacecraft for a given step_number."""
	pg = propagator.Propagator()

	step_time = step_time * pk.DAY2SEC
	pos_vel = np.append(pos, vel)
	values = [np.append(date.mjd2000, pos_vel)]
	date = date * pk.DAY2SEC #* pk.DAY2SEC #date.mjd2000 * pk.DAY2SEC
	print date
	time_range = [date + step_time*i for i in xrange(step_number)]
	for i, time in enumerate(time_range):
            values.append(np.append(time*pk.SEC2DAY, pg.rk4(pg.rate_function, time, values[i][1:7], step_time, bodies)))
        return values
	 
